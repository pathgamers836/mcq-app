<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI MCQ App</title>
<style>
body { font-family: Arial; padding:20px; }
.option { padding:10px; margin:5px 0; border:1px solid #333; cursor:pointer; }
.correct { background-color:lightgreen; }
.wrong { background-color:#ff7f7f; }
.hidden { display:none; }
</style>
</head>
<body>

<div id="startScreen">
<h2>Select Subject</h2>

<select id="subject">
<option>History</option>
<option>Geography</option>
<option>Polity</option>
<option>Physics</option>
<option>Chemistry</option>
<option>Biology</option>
<option>Bihar Special</option>
<option>Current Affairs</option>
</select>

<br><br>

<input type="text" id="topic" placeholder="Enter Topic">

<br><br>

<button onclick="start()">Start</button>
</div>

<div id="quizScreen" class="hidden">
<h3 id="question">Loading...</h3>
<div id="options"></div>
<p id="explanation"></p>
<button onclick="next()">Next</button>
</div>

<script>

let correctIndex;

async function start(){
document.getElementById("startScreen").classList.add("hidden");
document.getElementById("quizScreen").classList.remove("hidden");
generate();
}

async function generate(){

let subject = document.getElementById("subject").value;
let topic = document.getElementById("topic").value;

document.getElementById("question").innerText="Generating...";

const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
method: "POST",
headers: {
"Authorization": "Bearer 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",
"Content-Type": "application/json"
},
body: JSON.stringify({
"model": "mistralai/mistral-7b-instruct",
"messages": [
{
"role": "user",
"content": `Generate 1 MCQ from ${subject} about ${topic}. 
Give question, 4 options, correct answer number and 2 line explanation in simple JSON format like:
{
"question":"",
"options":["","","",""],
"answer":0,
"explanation":""
}`
}
]
})
});

const data = await response.json();
const text = data.choices[0].message.content;

let mcq = JSON.parse(text);

document.getElementById("question").innerText = mcq.question;

correctIndex = mcq.answer;

let html="";
mcq.options.forEach((opt,i)=>{
html+=`<div class="option" onclick="check(${i})">${opt}</div>`;
});

document.getElementById("options").innerHTML=html;
document.getElementById("explanation").innerText="";
}

function check(i){
let opts=document.getElementsByClassName("option");
for(let j=0;j<opts.length;j++){
opts[j].onclick=null;
}

if(i===correctIndex){
opts[i].classList.add("correct");
document.getElementById("explanation").innerText=mcq.explanation;
}else{
opts[i].classList.add("wrong");
opts[correctIndex].classList.add("correct");
document.getElementById("explanation").innerText=mcq.explanation;
}
}

function next(){
generate();
}
</script>

</body>
</html>
